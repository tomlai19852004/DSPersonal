https://medium.com/@DonnyStark/messaging-system-architecture-in-node-js-part-1-4b75a40dd462?source=---
Messaging System Architecture in Node.js — Part 1Building a realtime app like messaging system is not hard to do in Node.js as its good for building realtime networking apps. But the hardest part is how are we gonna structure the system, the messaging system.This time I’m gonna tell you how do I build something like this in my way. First we need to structure the system, this is my architecture.Messaging System ArchitectureEvery rounded square is a service that we are going to develop. Every service has its own responsibility. Let’s define their responsibility.User UIActually this is not a service, this is just a client for the messaging service but, its better to know its responsibility.Should be able to send message to a conversation (Inbound Message)Should be able to list all available conversation or add another new conversation (Conversation Mapper)Should be able to stream data to a certain conversation (Outbound Message)So its all, for now.Inbound MessageThis service serves what User UI does, receive a new message from User UI. Then put it on a Message Queue, we’re gonna decide which MQ to use later. Now lets just define the responsibilities.Should be able to recieve a message (HTTP Server).Should be able to put a new message to MQ (Inbound Message Queue).Conversation RouterInbound Messages enqueue messages to a MQ, then something has to dequeue these messages and separate them based on their conversationId. Its what Conversation Router is going to do anyway. Comes to responsibility.Should be able to dequeue messagesShould be able to separate the messages based on their conversationId.Should be able to save the message body to message persistor (NoSQL).Should be able to enqueue separated message based on its own conversationId to outbound MQ (messageId only).Message PersistorMessage persistor is a service that saves incoming messages to NoSQL database and off course reads a message body by messageId from NoSQL.Should be able to save a message body to NoSQL Database.Should be able to read a message from NoSQL Database by messageId.Outbound MessageSomething has to help User UI to update its data frequently in near realtime by using SSE. It’s what Outbound Message does.Should be able to serve User UI in a realtime data transfer (SSE).Should be able to read new messages for each listened conversation from outbound MQ.Conversation MapperThis service translates a specific user conversation group to an unique conversationId.Should be able to create a new conversationId for every new conversation.Should be able to list all available conversations for a specific user.Okay we’re done defining each service’s responsibilities. Then its time for Node.js stuffs..But wait, its gonna be on the next part, we are going to decide which solution that fits our needs in this system including MQ and NoSQL.See you on the next part.